
/* 
  VARIABILI E RESET 
  Definisce le variabili CSS per il tema chiaro e resetta gli stili di base
*/

:root {
  --border-radius: 8px;
  --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  --group-header-height: 42px;

  /* TABBAR / ICONE */
  --tabbar-bg:  #242424;               /* Grigio antracite molto scuro (sfondo della tabbar) */
  --icon-color: #f5f5f5;               /* Bianco quasi puro (colore base delle icone) */
  --icon-active-color: #00d4ff;        /* Azzurro ciano brillante (icone attive) */
  --ripple-color: rgba(255, 255, 255, 0.4); /* Bianco con trasparenza 40% (effetto ripple/tocco) */
  --tabbar-icon-size: 60px;            /* Dimensione icone tabbar */
  --tabbar-icon-stroke: 1.0;           /* Spessore linea icone tabbar */

  /* PALETTE PRINCIPALE (tema chiaro) */
  --primary-color: #5a6de0;            /* Blu lavanda (colore principale dell'interfaccia) */
  --secondary-color: #6dd47e;          /* Verde menta chiaro (accenti secondari) */
  --dark-bg: #f5f7fa;                  /* Bianco-grigio molto chiaro (sfondo principale) */
  --card-bg: #ffffff;                  /* Bianco puro (sfondo card e pannelli) */
  --card-hover: #e3f2fd;               /* Azzurro molto tenue (hover sulle card) */
  --text-primary: #2c2c2c;             /* Grigio quasi nero (testo principale) */
  --text-secondary: #5a6de0;           /* Blu lavanda (testo secondario, link) */
  --accent-color: #eceff1;             /* Grigio freddo molto chiaro (accenti e bordi) */
  --danger-color: #e57373;             /* Rosso tenue pastello (errori leggeri) */
  --group-header-bg: #e0e7ff;          /* Lavanda chiarissima (sfondo intestazioni gruppi) */
  --accent-shadow: rgba(76, 201, 240, 0.2); /* Azzurro ciano trasparente (ombre soffuse) */
  --active-channel-border: #ff9800;    /* Arancione vivo (bordo canale attivo) */

  /* TOGGLE / SWITCH */
  --toggle-active-green: #81c784;      /* Verde pastello (toggle ON) */
  --toggle-on-label: #388e3c;          /* Verde scuro (etichetta ON) */
  --toggle-off-label: var(--text-secondary); /* Usa il blu secondario (etichetta OFF) */

  /* BORDI / CONTROLLI / BUTTON */
  --border-color: #e0e0e0;             /* Grigio chiaro (bordi tiles e sezioni) */
  --border-controls: #d6d6d6;          /* Grigio medio chiaro (bordi pulsanti/controlli) */
  --active-btn: #e8eaf6;               /* Azzurro-grigio molto chiaro (pulsante attivo) */
  --button-bg: #f0f0f0;                /* Grigio molto chiaro (sfondo base pulsanti) */

  /* INPUT / SCROLLBAR */
  --input-bg: #fafafa;                 /* Grigio molto chiaro (sfondo input) */
  --scrollbar-track: #eeeeee;          /* Grigio chiaro (binario scrollbar) */
  --channel-bg: #f8f9fa;               /* Bianco ghiaccio (sfondo lista canali) */
  --active-channel-bg: rgba(90, 109, 224, 0.15); /* Azzurro-blu tenue trasparente (canale attivo evidenziato) */

  /* STELLE PREFERITI */
  --favorite-star: #fbc02d;            /* Giallo oro soft (stella attiva) */
  --favorite-star-hover: #ffeb3b;      /* Giallo acceso (hover sulla stella) */
  --favorite-star-inactive: #b0b0b0;   /* Grigio spento (stella inattiva) */
  --active-channel-color: var(--toggle-active-green); /* Verde toggle per icone/testi di canali attivi */

  --epg-poster-bg: #f9f9f9;            /* Grigio quasi bianco (sfondo poster EPG) */
  --metadata-subtext: #666666;         /* Grigio medio (informazioni secondarie) */
  --button-disabled: #cccccc;          /* Grigio chiaro uniforme (pulsanti disabilitati) */

  /* NOTIFICHE */
  --notification-success-bg: #e8f5e9;      /* Verde molto chiaro (sfondo notifica success) */
  --notification-success-text: #2e7d32;    /* Verde scuro (testo notifica success) */
  --notification-success-border: #66bb6a;  /* Verde medio (bordo notifica success) */
  --notification-error-bg: #fdecea;        /* Rosso-rosa pallido (sfondo notifica errore) */
  --notification-error-text: #c62828;      /* Rosso scuro (testo errore) */
  --notification-error-border: #ef5350;    /* Rosso medio (bordo errore) */
}


/* TEMA SCURO */

:root.dark-theme {

  /* COLORI PRINCIPALI */
  --primary-color: #ff4d4d;            /* Rosso acceso brillante (accento principale dark) */
  --secondary-color: #4dff4d;          /* Verde neon brillante (accento secondario) */

  /* SFONDI */
  --dark-bg: #1c1c1c;                  /* Nero/grigio antracite profondo (sfondo app) */
  --card-bg: #242424;                  /* Grigio scuro pieno (card) */
  --card-hover: #2E7D32;               /* Verde scuro (hover card in dark) */

  /* TESTO */
  --text-primary: #f5f5f5;             /* Bianco quasi pieno (testo principale su sfondi scuri) */
  --text-secondary: #4da6ff;           /* Azzurro vivo (testo secondario/link) */
  --accent-color: #E0E0E0;             /* Grigio chiaro (accenti/bordi in dark) */
  --danger-color: #e60039;             /* Rosso elegante profondo (errori) */
  --group-header-bg: #2b2d42;          /* Blu-ardesia scuro (testate gruppi in dark) */
  --tabbar-bg: rgba(20, 20, 20, 0.6);  /* Nero semitrasparente (sfondo tabbar) */
  --active-channel-border: #E0E0E0;    /* Grigio chiaro (bordo canale attivo in dark) */

  /* TOGGLES */
  --toggle-active-green: #2E7D32;      /* Verde scuro standard (toggle ON in dark) */
  --toggle-on-label: #2E7D32;          /* Verde scuro (etichetta ON) */
  --toggle-off-label: var(--text-secondary); /* Azzurro vivo (etichetta OFF) */

  /* BORDI E CONTROLLI */
  --border-color: #2a2a2a;             /* Grigio scurissimo (bordi minimali) */
  --border-controls: #333333;          /* Grigio scuro leggibile (controlli) */
  --active-btn: #2f2f2f;               /* Grigio scuro (pulsante attivo) */
  --button-bg: #2b2b2b;                /* Grigio molto scuro (pulsanti base) */

  /* INPUT / LISTE / SCROLLBAR */
  --input-bg: #2a2a2a;                 /* Grigio molto scuro (input) */
  --scrollbar-track: #2a2a2a;          /* Grigio molto scuro (scrollbar track) */
  --channel-bg: #202020;               /* Grigio nerastro (sfondo lista canali) */
  --active-channel-bg: rgba(77, 166, 255, 0.12); /* Azzurro tenue (evidenziazione canale attivo) */

  /* STELLE */
  --favorite-star: #ffd700;            /* Oro brillante (stella attiva dark) */
  --favorite-star-hover: #ffea70;      /* Oro pi√π chiaro (hover) */
  --favorite-star-inactive: #777777;   /* Grigio spento (stella inattiva) */
  --active-channel-color: var(--favorite-star); /* Oro (canale attivo) */
  --epg-poster-bg: #262626;            /* Grigio molto scuro (sfondo poster EPG) */
  --metadata-subtext: #bbbbbb;         /* Grigio chiaro (testo secondario) */
  --button-disabled: #666666;          /* Grigio medio (pulsanti disabilitati) */

  /* NOTIFICHE */
  --notification-success-bg: #d4edda;     /* Verde chiaro (success) */
  --notification-success-text: #155724;   /* Verde molto scuro (testo success) */
  --notification-success-border: #28a745; /* Verde acceso (bordo success) */
  --notification-error-bg: #f8d7da;       /* Rosa/rosso chiaro (errore) */
  --notification-error-text: #721c24;     /* Rosso molto scuro (testo errore) */
  --notification-error-border: #dc3545;   /* Rosso brillante (bordo errore) */
}


/* Abilita transizioni solo se supportate */
@media (prefers-reduced-motion: no-preference) {
  :root, :root.dark-theme {
    transition: var(--transition);
  }
}

* {
  margin: 0;
  padding: 0;
  -webkit-tap-highlight-color: transparent;
  box-sizing: border-box;
}

/* 
  LAYOUT BASE 
  Stili per la struttura principale della pagina
*/
html, body {
  height: 100%;
  min-height: 100vh;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  background: var(--dark-bg);
  color: var(--text-primary);
  touch-action: manipulation;
  line-height: 1.5;
}

body {
  display: flex;
  flex-direction: column;
  padding: 12px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* 
  STILI PER INPUT E PULSANTI 
  Componenti riutilizzabili per gli elementi di input
*/
.text-input {
  flex: 1;
  min-width: 60px; 
  padding: 8px 12px;
  padding-right: 30px;
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  background: var(--input-bg);
  color: var(--text-primary);
  font-size: 0.9rem;
  transition: var(--transition);
  height: 36px;
  line-height: 20px;
}

.text-input:focus {
  outline: none;
  border-color: var(--accent-color);
  box-shadow: 0 0 0 2px var(--accent-shadow);
}

.input-container {
  position: relative;
  flex: 1;
  display: flex;
  min-width: 60px; 
  align-items: center;
}

.clear-input {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  cursor: pointer;
  color: var(--text-secondary);
  font-size: 1.6rem;
  text-align: center;
  line-height: 18px;
  display: none;
  width: 20px;
  height: 20px;
}

.clear-input:hover {
  color: var(--text-primary);
}

/* 
  HEADER 
  Stili per l'intestazione dell'applicazione
*/
h1 {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 8px;
  background: var(--card-bg);
  border-radius: var(--border-radius);
  margin-bottom: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  height: 56px;
  border: 1px solid var(--border-controls);
  gap: 8px;
flex-shrink: 0; /* impedisce che diventi pi√π corto */
}

h1 .elegant-toggle-container {
  margin-left: auto;
}

/* Raggruppamento pulsanti header */
#M3UButtonInside,
#exportButton,
#resetListBtn,
#optionsBtn,
#hardReset,
#loadM3UDefault,
#resetM3U,
#saveM3UDefault,
#searchBtn { 
  height: 40px;
  padding: 2px 2px;
  border-radius: var(--border-radius);
  background: var(--card-bg);
  border: none;
  cursor: pointer;
  transition: var(--transition);
}

#M3UButtonInside:hover,
#exportButton:hover,
#resetListBtn:hover,
#optionsBtn:hover,
#hardReset:hover,
#loadM3UDefault:hover,
#resetM3U:hover,
#saveM3UDefault:hover,
#searchBtn:hover { 
  background: var(--card-hover);

}
#hardReset:hover {
  background-color: var(--danger-color);
}


/* 
  CONTROLLI 
  Area contenente i pulsanti e i controlli principali
*/
#controls {
  display: flex;
  gap: 8px;
  height: 4px; /* sottile fascia decorativa */
  margin-bottom: 12px;
  background: var(--toggle-active-green);
  border-radius: var(--border-radius);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
  flex-wrap: wrap;
  border: 1px solid var(--border-controls);
}

button {
  padding: 8px 14px;
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  background: var(--button-bg);
  color: var(--text-primary);
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  font-size: 0.9rem;
}

button:hover {
  background: var(--card-hover);
}

button:disabled {
  background: var(--button-bg);
  color: var(--button-disabled);
  cursor: not-allowed;
}

.active-btn {
  background: var(--accent-color);
  color: var(--text-primary);
  border-color: var(--accent-color);
  font-weight: 600;
}


/* 
  LISTA CANALI 
  Stili per il contenitore della lista dei canali
*/

/* Stili comuni a container principali */
#channelListContainer,
#fullEpgContainer,
#playerContainer {
  border-radius: var(--border-radius);
  background: var(--card-bg);
  border: 1px solid var(--border-controls);
}

/* Stili specifici */
#channelListContainer,
#fullEpgContainer {
  flex: 1;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  /* IMPORTANT: layout a colonna per header + scroller */
  display: flex;
  flex-direction: column;
}

/* Riserva spazio per la bottom bar sui container principali */
#channelListContainer,
#fullEpgContainer,
#playerContainer {
  padding-bottom: calc(72px + env(safe-area-inset-bottom));
}

#playerContainer {
  display: none;
  padding: 16px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); /* diverso dagli altri */
}

/* Dettaglio EPG (drawer) */
#channelEpgDetail {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* Contenitore dei programmi nel drawer */
#channelEpgPrograms {
  flex: 1;
  max-height: calc(100vh - 100px);
  overflow-y: auto;
  padding: 10px;
}


/* lista canali principale (rimane altezza 100% nel suo container) */
#channelList {
  height: 100%;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--accent-color) var(--scrollbar-track);
}

/* FULL EPG: deve occupare lo spazio rimanente sotto .group-header e scorrere correttamente */
#fullEpgList {
  flex: 1; /* prende lo spazio disponibile sotto l'header */
  overflow-y: auto;
  box-sizing: border-box;
  padding-bottom: calc(72px + env(safe-area-inset-bottom)); /* riserva spazio per la bottom bar */
  scrollbar-width: thin;
  scrollbar-color: var(--accent-color) var(--scrollbar-track);
}

/* webkit scrollbars per entrambe le liste */
#channelList::-webkit-scrollbar,
#fullEpgList::-webkit-scrollbar {
  width: 6px;
}

#channelList::-webkit-scrollbar-track,
#fullEpgList::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
}

#channelList::-webkit-scrollbar-thumb,
#fullEpgList::-webkit-scrollbar-thumb {
  background-color: var(--accent-color);
  border-radius: 3px;
}

/* 
  GRUPPI DI CANALI 
  Stili per i gruppi di canali con intestazioni espandibili
*/
.group-header {
  padding: 0 12px;
  background: var(--group-header-bg);
  color: var(--text-primary);
  font-weight: 600;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  position: sticky;
  top: 0;
  z-index: 10;
  height: var(--group-header-height);
  border-bottom: 1px solid var(--border-color);
}

.group-title {
  flex: 1;
  display: flex;
  align-items: center;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.group-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 4px;
  background: rgba(255, 255, 255, 0.1);
  margin-left: 8px;
  font-weight: bold;
  font-size: 1rem;
}

.group-toggle.collapsed::before {
  content: "+";
}

.group-toggle.expanded::before {
  content: "-";
}

/* Aggiungi questo stile nella sezione CSS */
.group-channel-count {
  margin-left: auto;
  padding: 0 8px;
  font-size: 1rem;
  color: var(--text-primary);
  font-weight: normal;
}

/* 
  ITEM CANALE - Stili base
  (Modificato per supportare entrambe le modalit√†)
*/
.channel-item {
  border-radius: var(--border-radius);
  background: var(--channel-bg);
  transition: var(--transition);
  cursor: pointer;
  border: 1px solid var(--border-controls);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 3px 0 0 transparent;
  overflow: hidden;
  display: flex;
  padding: 10px;
  gap: 10px;
  box-sizing: border-box;
  position: relative;
}

/* Stili comuni per entrambe le modalit√† */
.channel-logo {
  border-radius: 12px;
  object-fit: contain;
  background: rgba(255, 255, 255, 0.05);
  padding: 2px;
}

/* Logo */
.channel-item.list .channel-logo {
  width: 60px;
  height: 60px;
}

.channel-item.grid .channel-logo {
  width: 80px;
  height: 60px;
}

.active-channel {
  background: var(--active-channel-bg) !important;
  /* non cambiare i bordi reali: usa inset box-shadow per la striscia sinistra */
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2), inset 3px 0 0 var(--active-channel-border);
}

/* 
  PLAYER 
  Stili per il riproduttore multimediale
*/
#playerContainer.audio-mode {
  background: var(--group-header-bg);
}

video {
  width: 100%;
  border-radius: var(--border-radius);
  aspect-ratio: 16/9;
  background: #000;
  margin-bottom: 16px;
}

#playerContainer.audio-mode #player {
  height: 0px;
  background: transparent;
  border: none;
  box-shadow: none;
  margin: 20px 0;
  display: block !important;
  object-fit: contain;
}

#currentChannelInfo {
  display: flex;
  align-items: center;
  margin-bottom: 16px;
  padding: 12px;
  background: var(--scrollbar-track);
  border-radius: var(--border-radius);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
}

#currentChannelLogo {
  width: 44px;
  height: 44px;
  border-radius: 8px;
  margin-right: 12px;
  object-fit: contain;
  background: rgba(255, 255, 255, 0.05);
  padding: 3px;
}

#currentChannelName {
  font-size: 1rem;
  font-weight: 500;
  flex: 1;
  color: var(--text-primary);
}

#currentChannelGroup {
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-left: 12px;
}

.player-controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 16px;
}

.player-controls button {
  flex: 1;
  max-width: 140px;
  padding: 10px;
  font-weight: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
}

/* 
  PREFERITI 
  Stili per i canali preferiti (con stella)
*/
.favorite-star {
  display: inline-block;
  color: var(--favorite-star);
  font-size: 1.6rem;
  align-self: center;
  margin-left: auto;
  cursor: pointer;
  transition: var(--transition);
  flex-shrink: 0;
}

.favorite-star:hover {
  transform: scale(1.2);
  color: var(--favorite-star-hover);
}

.favorite-star.inactive {
  color: var(--favorite-star-inactive);
}

.favorite-star.grid-star {
  margin-top: 2px;
  font-size: 1rem;
}

/* 
  PULSANTE ELIMINA 
  Stile per il pulsante di eliminazione canale
*/
.delete-channel{
  margin-left: 8px;
  cursor: pointer;
  font-size: 0.8rem;
  align-self: center;
  transition: var(--transition);
}

.reload-epg {
  font-size: 1.8rem;          /* stessa dimensione del cestino */
  align-self: center;         /* centra verticalmente nella tile (come .delete-channel) */
  margin-left: 8px;           /* stesso spazio a sinistra */
  cursor: pointer;
  transition: var(--transition);
  display: inline-flex;       /* evita comportamenti di linea strani */
  justify-content: center;
  align-items: center;
  line-height: 1;
  user-select: none;
}

/* Stato ‚Äúloading‚Äù per la freccia EPG: mostra uno spinner coerente con il tema */
.reload-epg.loading {
  font-size: 0;               /* nasconde la ‚Üª senza cambiare dimensioni */
  position: relative;
}

.reload-epg.loading::after {
  content: "";
  width: 18px;
  height: 18px;
  border: 2px solid color-mix(in srgb, var(--text-secondary), transparent 60%);
  border-top-color: var(--accent-color);   /* colore tematico centrale */
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

.delete-channel:hover,
.reload-epg:hover {
  transform: scale(1.1);
}

/* 
  ITEM CANALE 
  Stili per gli elementi singoli del canale
*/
.channel-item.grid {
  flex-direction: column;
  justify-content: space-between;
  width: 120px;
  height: 120px;
}

/* Centra SOLO l'icona */
.channel-item.grid .channel-logo {
  margin: 0 auto;
  display: block;
  width: 60px;
  height: 60px;
}

/* nasconde la freccia di reload nelle tiles grid */
.channel-item.grid .reload-epg { 
  display: none !important; 
  pointer-events: none; /* opzionale: disabilita click */
}

.grid-name {
  max-width: 90%;
  font-size: 0.9rem;
}

/* 
  LAYOUT GRIGLIA/LISTA 
  Stili per i diversi layout di visualizzazione
*/
.group-content.grid-view {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}

.group-content.list-view {
  display: flex;
  flex-direction: column;
  gap: 0;
}

.channel-item.list {
  display: flex;
  align-items: center;   /* invece di flex-start */
  margin-bottom: 0;
}

/* Uniforma le righe del FULL EPG alla lista canali */
#fullEpgList .channel-item.list {
  min-height: 82px;
  align-items: center;
  display: flex;

}

/* Nome canale */
.channel-item.list .channel-name {
  font-size: 1.1rem;
  font-weight: 500;
  margin-left: 10px;
  color: var(--text-primary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: left;
  max-width: 70%;
}

.channel-item.grid .channel-name {
  font-size: 1rem;
  color: var(--text-primary);
  padding: 0 6px;
  text-align: center;
  max-width: 100%;
  box-sizing: border-box;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  display: block;
}

/* Evidenzia SOLO il nome del canale attivo (colore dipende dal tema) */
.channel-item.active-channel .channel-name {
  color: var(--active-channel-color);
  font-weight: 600; /* opzionale */
}

/* Programma in corso */
.channel-item.list .current-program {
  font-size: 0.85rem;
  color: var(--text-secondary);
  margin-left: 10px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  word-break: break-all;
}

.channel-item.grid .current-program {
  display: none;
}

/* 
  GESTIONE VISIBILIT√Ä STELLE PREFERITI 
  Mostra/nasconde le stelle in base alla modalit√†
*/

/* Stella preferiti */
.channel-item.grid .favorite-star {
  display: none;
}

/* Cestino */
.channel-item.grid .delete-channel {
  display: none;
}

/* 
  TOGGLE ELEGANTE 
  Stili per gli switch toggle (ispirati a iOS)
*/
.elegant-toggle-container {
  display: flex;
  align-items: center;
  margin: 0 4px;
  height: 36px;
  gap: 12px;
}

.elegant-toggle-container:has(input:checked) .elegant-toggle-label {
  color: var(--toggle-on-label);
}

.elegant-toggle {
  position: relative;
  display: inline-block;
  width: 52px;
  height: 32px;
  flex-shrink: 0;
}

.elegant-toggle input {
  opacity: 0;
  width: 0;
  height: 0;
}

.elegant-toggle-handle {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: var(--card-bg);
  border: 1px solid var(--accent-color);
  transition: all 0.3s cubic-bezier(0.65, 0.05, 0.36, 1);
  border-radius: 16px;
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}

.elegant-toggle-handle:before {
  position: absolute;
  content: "";
  height: 26px;
  width: 26px;
  left: 2px;
  bottom: 2px;
  background-color: var(--accent-color);
  transition: transform 0.3s cubic-bezier(0.65, 0.05, 0.36, 1);
  border-radius: 50%;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.elegant-toggle input:checked + .elegant-toggle-handle {
  background-color: var(--toggle-active-green);
  border-color: var(--toggle-active-green);
}

.elegant-toggle input:checked + .elegant-toggle-handle:before {
  background-color: var(--accent-color);
  transform: translateX(20px);
}

.elegant-toggle-label {
  order: -1;
  margin-right: 8px;
  font-size: 0.9rem;
  font-weight: 500;
  color: var(--toggle-off-label);
  transition: color 0.3s ease;
}

.elegant-toggle input:checked ~ .elegant-toggle-label {
  color: var(--toggle-on-label);
}

.elegant-toggle input:disabled + .elegant-toggle-handle {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Stili per la sezione metadati */
.metadata-title {
  font-weight: 600;
  margin-bottom: 8px;
  color: var(--text-secondary);
}

.metadata-label {
  font-weight: 500;
  color: var(--text-secondary);
}

.metadata-input {
  width: 100%;
  padding: 4px 8px;
  border-radius: 4px;
  border: 1px solid var(--border-color);
  background: var(--input-bg);
  color: var(--text-primary);
  font-family: inherit;
  font-size: inherit;
}

.metadata-input:focus {
  outline: none;
  border-color: var(--accent-color);
  box-shadow: 0 0 0 2px var(--accent-shadow);
}

select.metadata-input {
  padding: 3px 6px;
}

.metadata-value {
  word-break: break-word;
  display: flex;
  align-items: center;
}

/* Stile per l'header dei metadati */
.metadata-header {
  background: var(--card-bg);
  padding: 8px 12px;
  margin-top: 12px;
  border-radius: var(--border-radius);
  cursor: pointer;
  display: flex;
  align-items: center;
  border: 1px solid var(--border-controls);
}

#metadataContainer {
  max-height: 0;
  overflow: hidden;
  padding: 0;
  transition: max-height 0.3s ease, padding 0.3s ease;
  background: var(--card-bg);
  border-radius: var(--border-radius);
  margin-top: 2px;
  border: 1px solid var(--border-controls);
}

#metadataContainer.expanded {
  max-height: 1000px;
  padding: 16px;
  margin-top: 8px;
}

.metadata-grid {
  opacity: 0;
  transition: opacity 0.2s ease 0.1s;
  display: grid;
  grid-template-columns: max-content 1fr;
  gap: 8px 16px;
}

#metadataContainer.expanded .metadata-grid {
  opacity: 1;
}

.metadata-arrow, 
.epg-arrow {
  display: inline-block;
  margin-right: 8px;
  transition: transform 0.2s ease;
  font-size: 0.9em;
  color: var(--toggle-active-green);
}

#epgHeader {
  cursor: pointer;
  display: flex;
  align-items: center;
  margin-bottom: 8px;
}

#epgContent {
  max-height: 300px;
  overflow-y: auto;
}

/* PROGRAMMI EPG */
.epg-program {
  display: flex;
  padding: 12px;
  margin-bottom: 10px;
  border-radius: 8px;
  gap: 15px;
  background: rgba(255,255,255,0.05);
  transition: all 0.3s ease;
}

.epg-program.current {
  background: rgba(76, 201, 240, 0.15);
}

.epg-poster-container {
  flex-shrink: 0;
  width: 80px;
  height: 100px;
  border-radius: 6px;
  overflow: hidden;
  position: relative;
  background: var(--epg-poster-bg);
}

.epg-poster {
  width: 100%;
  height: 100%;
  object-fit: contain;
  transition: opacity 0.3s ease;
}

.epg-date {
  margin: 4px 0;
  font-size: 0.75em;
  color: #ccc;
  text-align: center;
}

.poster-with-date {
  display: flex;
  flex-direction: column; /* poster sopra, testo sotto */
  align-items: center;    /* centrato orizzontalmente */
  gap: 4px;
}

/* stile data sotto il poster */
.poster-with-date .epg-date {
  margin: 2px 0;
  font-size: 0.75em;
  color: #ccc;
  text-align: center;
}

/* stile orario sotto il poster */
.poster-with-date .epg-time {
  margin: 2px 0;
  font-size: 0.9rem;            /* stile iniziale */
  color: var(--text-secondary); /* colore iniziale */
  text-align: center;
  white-space: normal;
  margin-left: 0;               /* elimina spostamento da titolo */
}

.epg-details {
  flex: 1;
  min-width: 0;
}

.epg-title-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.epg-title {
  font-size: 1.1rem;
  font-weight: bold;
  overflow: hidden;
  text-overflow: ellipsis;
}

.epg-time {
  font-size: 0.9rem;
  color: var(--text-secondary);
  white-space: nowrap;
  flex-shrink: 0;
  margin-left: 10px;
  text-align: center;
}

.epg-subtitle {
  margin-top: 5px;
  font-size: 0.95rem;
  color: var(--metadata-subtext);
}

.epg-description {
  margin-top: 8px;
  font-size: 0.9rem;
  white-space: normal;
}

.epg-duration {
  display: inline-block;
  margin-top: 5px;
  padding: 2px 6px;
  background: rgba(255,255,255,0.1);
  border-radius: 4px;
  font-size: 0.8rem;
}

/* LOADER IMMAGINI */
.epg-loader {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255,255,255,0.3);
  border-radius: 50%;
  border-top-color: var(--accent-color);
  animation: spin 1s linear infinite;
  z-index: 2;
}

.epg-progress-bar-container {
  width: 80%;               /* larghezza normalizzata */
  height: 4px;
  background: rgba(255,255,255,0.2);
  border-radius: 2px;
  margin: 4px auto 0 auto;  /* centrata sotto l‚Äôorario */
  overflow: hidden;
}

.epg-progress-bar {
  height: 100%;
  background: #4cc9f0;      /* colore evidenziato */
  width: 0%;                 /* impostato dinamicamente inline */
  transition: width 0.5s linear;
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to   { transform: rotate(360deg); }
}

.input-spinner {
  position: absolute;
  right: 8px;
  width: 18px;
  height: 18px;
  border: 2px solid rgba(0,0,0,0.12);
  border-top-color: var(--accent-color);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

.input-spinner.hidden {
  display: none !important;
}

/* Stili cambio opacit√† tasti con icone */
#downloadEpgBtn {
  transition: opacity 0.3s ease;
}

/* small inline loading used inside bottom-sheet */
.modal-loading {
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: center;
  padding: 8px 0;
  font-weight: 600;
}

.modal-loading.hidden { display: none !important; }

.modal-loading .spinner {
  width: 18px;
  height: 18px;
  border: 2px solid rgba(0,0,0,0.12);
  border-top-color: var(--accent-color);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

/* Spinner dentro al bottone Scarica EPG */
#downloadEpgBtn.loading {
  opacity: 0.3;
  cursor: not-allowed;
  pointer-events: none; 
  position: relative;
  color: transparent; /* nasconde testo/emoji senza cambiare dimensioni */
  pointer-events: none; /* blocca click mentre carica */
}

#downloadEpgBtn.loading::after {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 16px;
  height: 16px;
  margin: -8px 0 0 -8px;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: white; /* oppure var(--accent-color) se vuoi personalizzarlo */
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
}

/* Stili per le notifiche */
.notification {
  position: fixed;
  bottom: 20px;
  right: 20px;
  padding: 10px 20px;
  border-radius: 5px;
  z-index: 4000;
  box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  animation: fadeIn 0.3s ease-out;
}

.notification.success {
  background: var(--notification-success-bg);
  color: var(--notification-success-text);
  border-left: 4px solid var(--notification-success-border);
}

.notification.error {
  background: var(--notification-error-bg);
  color: var(--notification-error-text);
  border-left: 4px solid var(--notification-error-border);
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Sidebar (REPLACEMENT) */
.sidebar {
  height: 100%;
  width: 350px;            /* default width of the drawer */
  max-width: 90%;
  position: fixed;
  top: 0;
  right: 0;
  background: var(--card-bg);
  border-left: 1px solid var(--border-controls);
  z-index: 3000;
  display: flex;
  flex-direction: column;
  box-shadow: -4px 0 12px rgba(0,0,0,0.4);
  transform: translateX(100%);           /* hidden offscreen when closed */
  transition: transform 280ms cubic-bezier(.2,0,.0,1);
  will-change: transform;
  overflow: visible;                 
  touch-action: pan-y;                   /* we handle touch gestures */
}

/* Open state */
.sidebar.open {
  transform: translateX(0);
}

.sidebar-content {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
}
 
/* Overlay that dims the page when drawer open */
.sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: transparent;
  z-index: 2990;
  opacity: 0;
  pointer-events: none;

}
.sidebar-overlay.active {
  opacity: 1;
  pointer-events: all;
}

/* Handle (small visible tab always at the right edge) */
.sidebar-handle {
  position: absolute;
  top: 46%;
  left: -24px;
  transform: translateY(-50%);
  z-index: 3100;
  width: 24px;
  height: 54px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: grab;
  touch-action: none;
  border-radius: 8px 0 0 8px;
  box-shadow: -2px 0 8px rgba(0,0,0,0);
  background: linear-gradient(180deg, rgba(255,255,255,0), rgba(0,0,0,0));
}

/* grip visual inside handle */
.sidebar-handle-grip {
  width: 6px;
  height: 44px;
  border-radius: 3px;
  background: rgba(0,0,0,0.05);
}

/* small accessibility focus effect */
.sidebar-handle:focus {
  outline: 2px solid var(--primary-color);
  outline-offset: 2px;
}

.sidebar-header {
  padding: 12px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--group-header-bg);
  border-bottom: 1px solid var(--border-controls);
  font-weight: 600;
  font-size: 1.4rem;
}

.sidebar-tabs {
  display: flex;
  border-bottom: 1px solid var(--border-controls);
}

.tab-btn {
  flex: 1;
  padding: 10px;
  background: none;
  border: none;
  cursor: pointer;
  color: var(--text-secondary);
  font-weight: 500;
}

.tab-btn.active {
  border-bottom: 1px solid var(--primary-color);
  color: var(--text-primary);
}

.tab-content { 
  display: none; 
}

.tab-content.active { 
  display: block; 
}

.option-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin: 12px 0;
  gap: 8px;
  min-height: 36px;
}

.option-row input[type="text"],
.option-row select {
  flex: 1;
  padding: 6px 8px;
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  background: var(--input-bg);
  color: var(--text-primary);
}

.option-row button {
  padding: 6px 12px;
}

.option-row.column {
  flex-direction: column;
  align-items: flex-start;
}

.option-row.column label {
  margin-bottom: 4px;
  font-size: 0.9rem;
  color: var(--text-secondary);
}

/* Stile specifico per i paragrafi nel tab Info */
#tabInfo p {
  margin: 12px 0;
  line-height: 2;
}

.input-with-btn {
  display: flex;
  width: 100%;
  gap: 6px;
}

.input-with-btn input {
  flex: 1;
}

#fontSizeRange { 
  width: 120px; 
}

.text-input::placeholder {
  font-size: 1.1rem;
}

#epgDrawer {
  overflow-y: auto;
}

/* Lista URL M3U */
#savedM3UList {
  margin: 0;
  padding: 0;
  width: 100%;
  list-style: none;
  box-sizing: border-box;
}

.saved-url-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  width: 100%;
  padding: 10px 5px;
  box-sizing: border-box;
  border-bottom: 1px solid var(--primary-color);
}

.saved-url-link {
  flex: 1;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: var(--text-primary);
  text-decoration: none;
}

.saved-url-link:hover {
  text-decoration: underline;
  color: var(--secondary-color);
}

.delete-url-btn {
  background: none;
  border: none;
  cursor: pointer;
  font-size: 1rem;
  flex-shrink: 0;
  color: var(--danger-color);
  transition: var(--transition);
}

/* Messaggio "nessun URL" */
.no-url-message {
  padding: 10px;
  text-align: center;
  color: var(--text-secondary);
}

.hidden { 
  display: none !important; 
}

/* Drawer laterale per dettaglio EPG */
.epg-drawer {
  position: fixed;
  top: 0;
  right: 0;
  width: 350px;
  max-width: 80%;
  height: 100%;
  background: var(--card-bg);
  border-left: 1px solid var(--border-controls);
  box-shadow: -4px 0 12px rgba(0,0,0,0.4);
  z-index: 3000;
  display: flex;
  flex-direction: column;
  transform: translateX(100%);
  transition: transform 0.3s ease-in-out;
}

.epg-drawer.open {
  transform: translateX(0);
}

.drawer-header {
  display: flex;
  align-items: center;
  font-size: 1.4rem;
  padding: 12px;
  background: var(--group-header-bg);
  font-weight: 600;
  border-bottom: 1px solid var(--border-color);
}

.drawer-close {
  font-size: 1.4rem;
  cursor: pointer;
  margin-left: auto;
}

.drawer-programs {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
}

/* Programmi dentro il drawer */
.drawer-programs .epg-program {
  display: flex;
  gap: 10px;
  padding: 8px;
  margin-bottom: 8px;
  border-radius: 8px;
  background: rgba(255,255,255,0.05);
}

.drawer-programs .epg-program.current {
  background: rgba(76, 201, 240, 0.15);
}

.epg-detail-container {
  max-height: calc(100vh - 100px);
  overflow-y: auto;
  padding: 10px;
}

/* Bottom Sheet Moderno */
.bottom-sheet {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--card-bg);
  border-radius: 16px 16px 0 0;
  padding: 0 0;
  z-index: 4000;
  transform: translateY(100%);
  transition: transform 0.3s ease-out;
  max-height: 80vh;
  overflow-y: auto;
}

.bottom-sheet.open {
  transform: translateY(0);
}

.bottom-sheet-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  z-index: 3999;
  opacity: 0;
  transition: opacity 0.3s ease;
  pointer-events: none;
}

.bottom-sheet-overlay.open {
  opacity: 1;
  pointer-events: all;
}

.bottom-sheet-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 30px;  
}

.bottom-sheet-header h3 {
  margin: 0;
  font-size: 1.2rem;  
}

.bottom-sheet-close {
  font-size: 24px;
  cursor: pointer;
  color: var(--text-secondary);
}

.bottom-sheet-content {
  max-height: calc(40vh - 80px);
  overflow-y: auto;
  padding: 0 20px;   /* meno spazio verticale, laterali invariati */
}

.bottom-sheet-content input.metadata-input {
  width: 100%;                       /* piena larghezza */
  padding: 10px 12px;  
  margin-top: 0;
  margin-bottom: 14px;  
  height: 48px;
  border: 1px solid var(--border-color); 
  border-radius: var(--border-radius); /* usa la variabile globale */
  font-size: 1.2rem;
  background: var(--input-bg);       /* sfondo coerente con tema chiaro/scuro */
  color: var(--text-primary);
  box-sizing: border-box;
  transition: var(--transition);
}

/* Maniglia in alto al bottom sheet */
.bottom-sheet-handle {
  width: 50px;
  height: 6px;
  background: var(--border-color);
  border-radius: 3px;
  margin: 8px auto;
  cursor: grab;
  touch-action: none;
}

/* Area invisibile che prende i tocchi */
.bottom-sheet-drag-area {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 55px;             /* grande hit-area */
  background: transparent;  /* invisibile */
  cursor: grab;
  touch-action: none;
}

/* Focus */
.bottom-sheet-content input.metadata-input:focus {
  outline: none;
 
}

.bottom-sheet-actions {
  display: flex;
  flex-direction: column;      /* verticale, come i campi input */
  gap: 8px;                    /* distanza tra eventuali pulsanti */
  margin: 0 20px 20px 20px; /* meno spazio sopra e sotto */
}

.bottom-sheet-actions button {
  width: 100%;                 /* prende tutta la larghezza disponibile */
  padding: 12px 14px;   /* stessa altezza ridotta degli input */
  font-size: 14px;
  border-radius: var(--border-radius);
  border: none;
  box-sizing: border-box;
}

.input-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  width: 100%;
}

.input-wrapper input {
  width: 100%;
  padding-right: 30px; /* spazio per lo spinner */
}

.play-btn {
  margin-left: 8px;
  cursor: pointer;
  font-size: 0.9rem;
  background: var(--primary-color);
  color: #fff;
  border: none;
  border-radius: 4px;
  padding: 2px 6px;
  transition: 0.2s;
}

.play-btn:hover {
 background: var(--toggle-active-green);
 opacity: 0.8;
}

/* ---------- TAB BAR INFERIORE ---------- */
.tabbar {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  height: calc(56px + env(safe-area-inset-bottom));
  padding: 8px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  z-index: 2000; /* sopra tutto (ma sotto eventuali modali con z-index ancora pi√π alto) */
  padding-bottom: calc(8px + env(safe-area-inset-bottom));
 }

/* inserisci in fondo al <style> */
.tabbar, #bottomTabBar {
  -webkit-backdrop-filter: none !important;
  backdrop-filter: none !important;
  color: #fff;
  min-height: 72px;
}

/* Override specifico per i pulsanti della tab bar */
.tabbar-button {
  width: 48px;
  height: 48px;
  padding: 0 !important;
  border: none !important;
  background: transparent !important;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  box-shadow: none !important;
  border-radius: 8px;
  overflow: hidden;
}

/* assicurati che contenuto principale non venga coperto dalla tabbar */
#bottomTabBar.hidden {
  display: none !important;
}

/* container left nella tabbar: tiene i due tasti allineati a sinistra */
.tabbar-left {
  display: flex;             /* attiva flexbox */
  justify-content: space-between; /* distribuisce pulsanti su tutta la larghezza */
  align-items: center;       /* allinea verticalmente le icone */
  width: 100%;               /* occupa tutta la larghezza della barra */
  padding: 0 8px;            /* piccolo padding ai lati, opzionale */
  gap: 8px;                  /* distanza minima tra pulsanti, opzionale */
  max-width: 600px;      /* larghezza massima dei pulsanti */
}

/* Override mirato: assicura che i due pulsanti dentro la bottom bar abbiano 48x48,
   e sovrascrive l'impostazione di 40px che hai nel gruppo header */
/* imposta dimensione bottone per TUTTI i pulsanti della bottom bar */
#bottomTabBar #playlistsBtn,
#bottomTabBar #downloadEpgBtn,
#bottomTabBar #tabRenderLastChannel,
#bottomTabBar #fullEpgBtn,
#bottomTabBar #tabBackToChannels {
  width: var(--tabbar-icon-size);
  height: var(--tabbar-icon-size);
  padding: 0;
  display: inline-flex;
  align-items: center;
  justify-content: center;
}


/* Assicura che l'immagine interna riempia il bottone */
/* Assicura che l'icona SVG riempia il bottone per tutti i pulsanti */
#bottomTabBar #playlistsBtn .tabbar-icon,
#bottomTabBar #downloadEpgBtn .tabbar-icon,
#bottomTabBar #tabRenderLastChannel .tabbar-icon,
#bottomTabBar #fullEpgBtn .tabbar-icon,
#bottomTabBar #tabBackToChannels .tabbar-icon {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: block;
}

/* Nasconde il pulsante Back nella vista Full EPG senza rimuoverlo dal DOM */
#fullEpgBackBtn {
  display: none !important;
  pointer-events: none;
  visibility: hidden;
}

/* Contenitore dei preferiti vuoto */
#channelList.view-list,
#channelList.view-grid {
  position: relative;   /* serve come riferimento */
  min-height: 100%;     /* occupa tutta l‚Äôaltezza disponibile */
}

/* Immagine quando non ci sono preferiti */
.no-favorites,
.no-channels,
.no-epg {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
 border-radius: 16px;   /* üîπ angoli arrotondati */
}

/* header search (collapsed -> expanded) */
.search-toggle {
  background: none;
  border: none;
  cursor: pointer;
  width: 40px;
  height: 40px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  font-size: 1.05rem;
  margin-right: 6px;
  color: var(--text-secondary);
  flex-shrink: 0;
}

.header-search {
  display: flex;
  align-items: center;
  overflow: hidden;
  opacity: 1;
  transition: max-width 240ms ease, opacity 200ms ease;
  margin-left: 6px;
  box-sizing: border-box;
}

.header-search.expanded {
  max-width: 520px;           /* spazio massimo (aggiusta se vuoi) */
  opacity: 1;
}

/* input style specifico per la header search */
#headerSearchContainer .text-input {
  width: 100%;
  padding: 8px 12px;
  height: 38px;
  font-size: 1.0rem;
  border-radius: var(--border-radius);
  border: 1px solid var(--border-color);
  background: var(--input-bg);
  color: var(--text-primary);
  box-sizing: border-box;
}

/* chiaro adattamento per tema scuro gi√† gestito da variabili */
#headerSearchContainer .clear-input {
  margin-left: 8px;
  cursor: pointer;
  color: var(--text-secondary);
}

/* mobile: la ricerca occupi pi√π spazio se necessario */
@media (max-width: 600px) {
  .header-search.expanded {
    max-width: calc(100% - 140px); /* lascia spazio per icone a sinistra/destra */
  }
}

.pill-button {
  padding: 6px 18px;
  border-radius: 999px;
  border: 1px solid var(--border-controls);
  background: var(--card-bg);
  color: var(--text-secondary);
  font-weight: 600;
  font-size: 0.9rem;
  cursor: pointer;
  transition: var(--transition);
  min-width: 40px;
  text-align: center;
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  flex-shrink: 0;
}

.pill-button:hover {
  background: var(--card-hover);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* Stato attivo (Preferiti) */
.pill-button.active {
  background: var(--card-bg);
  border-color: var(--favorite-star);
  color: var(--favorite-star);
  box-shadow: 0 0 8px color-mix(in srgb, var(--favorite-star) 60%, transparent);
}

/* Stato non attivo (Tutti) */
.pill-button:not(.active) {
  background-color: var(--card-bg);
  border-color: var(--toggle-on-label);
  color: var(--toggle-on-label);
  box-shadow: 0 0 8px color-mix(in srgb, var(--toggle-on-label) 60%, transparent);
}

/* Gestione visibilit√† icone */
.pill-button .icon-preferiti {
  display: none;
}

.pill-button.active .icon-tutti {
  display: none;
}

.pill-button.active .icon-preferiti {
  display: block;
}

.pill-button:not(.active) .icon-tutti {
  display: block;
}

.pill-button:not(.active) .icon-preferiti {
  display: none;
}

/* ===== Pill button: stato modalit√† cancellazione ===== */
.pill-button.delete-mode {
  border-color: var(--danger, #d9534f);
  color: var(--danger, #d9534f);
  box-shadow: 0 0 8px color-mix(in srgb, var(--danger, #d9534f) 60%, transparent);
}

/* icona cestino dentro la pill (di default nascosta, visibile in delete-mode) */
.pill-button .icon-trash { display: none; }
.pill-button.delete-mode .icon-trash { display: block; }

/* nasconde icone "tutti" / "preferiti" quando in delete-mode (se vuoi) */
.pill-button.delete-mode .icon-tutti,
.pill-button.delete-mode .icon-preferiti {
  display: none;
}

/* delete button inside channel tile: di default nascosto */
.channel-item .delete-channel {
  display: none; /* nascosto di default */
  cursor: pointer;
  margin-left: 8px;
  user-select: none;
  font-size: 1.2rem;
}

/* quando attivo (modalit√† cancellazione) diventano visibili nelle list view */
.channel-item.list .delete-channel.visible {
  display: inline-block;
}

/* in grid view non cambia nulla: assicurati che .channel-item.grid non mostri la delete */
.channel-item.grid .delete-channel { display: none !important; }

/* üîπ PILL BUTTON VIEW MODE (Lista / Griglia) */
#viewModePill .icon-grid,
#viewModePill .icon-list {
display: none;
}

/* Mostra icona GRIGLIA quando siamo in grid mode */
#viewModePill.grid-mode .icon-grid {
  display: block;
}

/* Mostra icona LISTA quando siamo in list mode */
#viewModePill.list-mode .icon-list {
  display: block;
}

#viewModePill.collapse-mode {
  border-color: var(--favorite-star);
  color: var(--favorite-star);
  box-shadow: 0 0 8px color-mix(in srgb, var(--favorite-star) 60%, transparent);
}

/* üîπ Evita selezione testo o menu su long press (iOS fix) */
button, 
button * {
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

.group-drag-ghost {
  font-weight: 600;
  opacity: 0.98;
  backdrop-filter: blur(4px);
}

.group-header.dragging { opacity: 0.3; }

/* ===== BOTTOM SHEET STYLES ===== */
.sheet-actions-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  width: 100%;
}

.sheet-actions-grid .sheet-btn {
  width: 100%;
  text-align: center;
  padding: 12px 0;
  font-size: 16px;
  border-radius: var(--border-radius);
  background: var(--button-bg, #2d2f36);
  color: var(--button-color, #fff);
  border: 1px solid rgba(255,255,255,0.06);
  display: flex;
  align-items: center;
  justify-content: center;
  transition: background-color 0.2s ease, transform 0.15s ease, filter 0.15s ease;
  position: relative;
  overflow: hidden;
  color: var(--text-primary);
}

.sheet-btn svg {
  margin-right: 8px;
  margin-top: -1px;
}

.sheet-btn:active {
  transform: scale(0.97);
  filter: brightness(0.9);
}

/* ===== TABBAR STYLES ===== */
.tabbar {
  position: fixed;
  bottom: 0;
  width: 100%;
  height: 62px;
  display: flex;
  justify-content: center;
  align-items: center;
  background: var(--tabbar-bg);
  backdrop-filter: blur(12px);
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  z-index: 999;
}

.tabbar-left {
  display: flex;
  flex-direction: row;
  gap: 14px;
}

.tabbar-button {
  width: 42px;
  height: 42px;
  background: none;
  border: none;
  border-radius: 50%;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0;
  cursor: pointer;
  -webkit-tap-highlight-color: transparent;
  overflow: hidden;
  transition: transform 0.2s ease-out;
}

.tabbar-icon {
  stroke: var(--icon-color);
  stroke-width: var(--tabbar-icon-stroke);
  width: var(--tabbar-icon-size);
  height: var(--tabbar-icon-size);
  transition: stroke 0.25s ease;
}

.tabbar-button:active {
  transform: scale(0.92);
}

.tabbar-button:hover .tabbar-icon,
.tabbar-button:focus-visible .tabbar-icon {
  stroke: var(--icon-active-color);
}

.tabbar-button:active::after {
  content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  background: var(--ripple-color);
  border-radius: 50%;
  animation: ripple 0.4s ease-out forwards;
}

@keyframes ripple {
  0% {
    transform: scale(0);
    opacity: 0.7;
  }
  100% {
    transform: scale(2.4);
    opacity: 0;
  }
}

/* ===== SIDEBAR BUTTON STYLES ===== */
/* Grid container per Playlist e EPG tabs */
.button-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px;
  margin-top: 10px;
  width: 100%;
}

/* Tasti uniformi per Playlist e EPG sidebar - HOVER ORIGINALE */
#tabPlaylist .grid-btn,
#tabEPG .grid-btn {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 8px;
  padding: 12px 16px;
  font-size: 15px;
  background-color: var(--dark-bg);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.2s, transform 0.1s;
  height: 50px;
  width: 100%;
  color: var(--text-primary);
  text-align: left;
}

/* Icone dimensioni consistenti */
#tabPlaylist .grid-btn svg,
#tabEPG .grid-btn svg {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

/* HOVER ORIGINALE - Solo cambio colore di sfondo */
#tabPlaylist .grid-btn:hover,
#tabEPG .grid-btn:hover {
  background-color: var(--card-hover);
  /* Rimuovi transform per mantenere comportamento originale */
}

#tabPlaylist .grid-btn:active,
#tabEPG .grid-btn:active {
  transform: scale(0.97);
}

/* Input URL stessa altezza dei pulsanti */
#defaultM3UInput,
#defaultEPGInput {
  height: 50px;
  padding: 0 12px;
  font-size: 15px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  width: 100%;
  box-sizing: border-box;
  background: var(--input-bg, #2d2f36);
  color: var(--text-primary);
}

/* ===== ICON TEXT BUTTON STYLES ===== */
.icon-text-btn {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 14px;
  font-size: 0.95rem;
  border: 1px solid rgba(255, 255, 255, 0.2);
  background: rgba(255, 255, 255, 0.06);
  border-radius: 8px;
  width: 100%;
  cursor: pointer;
  transition: 0.18s ease;
}

.icon-text-btn .icon-reset {
  width: 42px;
  height: 42px;
  stroke: var(--text-primary);
  stroke-width: 1.0;
}

.icon-text-btn .btn-label {
  color: var(--text-primary);
  font-size: 0.95rem;
  font-weight: 500;
}

.icon-text-btn:hover {
  background: rgba(255, 255, 255, 0.18);
  transform: translateY(-1px);
  box-shadow: 0 1px 6px rgba(255, 255, 255, 0.15);
}

.icon-text-btn.warning {
  border-color: rgba(255, 80, 80, 0.4);
  background: rgba(255, 50, 50, 0.05);
}

.icon-text-btn.warning .icon-reset {
  stroke: #ff4c4c;
}

.icon-text-btn.warning:hover {
  background: rgba(255, 50, 50, 0.14);
  box-shadow: 0 2px 8px rgba(255, 50, 50, 0.3);
}

.icon-text-btn:active {
  transform: scale(0.96);
}

/* === üîß PATCH: Cambio tema istantaneo === */
/* 1Ô∏è‚É£ Disabilita global transition sul root */
@media (prefers-reduced-motion: no-preference) {
  :root,
  :root.dark-theme {
    transition: none !important; /* rimuove la transizione globale */
  }
}

/* 2Ô∏è‚É£ Aggiungi una classe temporanea per disattivare tutte le transizioni durante lo switch */
.disable-transitions *,
.disable-transitions *::before,
.disable-transitions *::after {
  transition: none !important;
  animation: none !important;
}

/* 3Ô∏è‚É£ Mantieni transizioni solo per piccoli elementi interattivi */
@media (prefers-reduced-motion: no-preference) {
  .pill-button,
  .elegant-toggle-handle,
  .tabbar-button,
  .notification,
  .channel-item .favorite-star {
    transition: background-color 0.2s ease, transform 0.12s ease, color 0.18s ease;
  }
}

/* 4Ô∏è‚É£ Ottimizza rendering dei molti elementi della lista */
.channel-item {
  contain: paint;
  will-change: auto;
}

.epg-message {
  width: 100%;
  text-align: center;
  font-style: italic;
}


<!-- Replace/hide old icons and add combined pill -->

  /* quick inline: assicurati che il pill abbia la stessa estetica */
  #optionsExportPill { cursor: pointer; }



